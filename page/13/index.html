<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"right","display":"hide","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="纪光的博客">
<meta property="og:url" content="http://yoursite.com/page/13/index.html">
<meta property="og:site_name" content="纪光的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="纪光的博客">
  <link rel="canonical" href="http://yoursite.com/page/13/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>纪光的博客</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bca403b673d79e83a47dc62fea1dd605";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">纪光的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
        
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      
    
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/25/flink/flink基本知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/25/flink/flink基本知识/" class="post-title-link" itemprop="url">flink基本知识</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-25 14:16:10" itemprop="dateCreated datePublished" datetime="2020-07-25T14:16:10+08:00">2020-07-25</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flink/" itemprop="url" rel="index">
                    <span itemprop="name">flink</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/25/flink/flink基本知识/" class="post-meta-item leancloud_visitors" data-flag-title="flink基本知识" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><h2 id="Transformation"><a href="#Transformation" class="headerlink" title="Transformation"></a>Transformation</h2><p>Transformation是指flink中所有的source、sink和中间转换的统一抽象。</p>
<h1 id="部署模式"><a href="#部署模式" class="headerlink" title="部署模式"></a>部署模式</h1><h2 id="Session模式"><a href="#Session模式" class="headerlink" title="Session模式"></a>Session模式</h2><ul>
<li>提前启动好一个集群，在这个集群中不断提交任务</li>
<li>所有任务共享集群资源</li>
<li>好处是：不需要每次创建集群是带来的resource开销，</li>
<li>问题是：隔离性差，一个TaskManager运行多个任务，其中一个任务导致TaskManager挂掉，会导致所有的任务重启；一个JobManager管理所有的任务，负载会成为瓶颈</li>
</ul>
<p>##Per-Job模式</p>
<ul>
<li>每个任务独立启动一个集群，隔离性好，每个任务有单独的JobManager管理，负载均衡</li>
</ul>
<p>##Application模式</p>
<ul>
<li><p>flink1.10版本新增的任务提交方式</p>
</li>
<li><p>Session和Per-Job的共同弊端是：Client端瓶颈，执行用户代码，生成Job graph，网络上传下载Jar包</p>
</li>
<li><p>解决思路：FLIP-85</p>
<blockquote>
<p>1.每个Application启动一个集群</p>
<p>2.JobManager端执行用户代码，没有单点瓶颈</p>
<p>3.YARN(FLINK-13938,FLINK-17632)、k8s支持</p>
<p>   提供了远程的lib目录，可以把这些文件缓存到YARN的节点上，不必要每次的上传/下载</p>
<p>   支持用户远程系统的Jar来创建任务，减少Jar包下载的开销   </p>
</blockquote>
</li>
</ul>
<p>#k8s和docker</p>
<h2 id="k8s生产可用性增强"><a href="#k8s生产可用性增强" class="headerlink" title="k8s生产可用性增强"></a>k8s生产可用性增强</h2><ul>
<li>Flink1.11版本达到生成可用的标准</li>
<li>FLINK-14460</li>
<li>基础功能：Node Selector、Label、Annotation、Toleration</li>
<li>根据环境变量自动挂载Hadoop配置</li>
</ul>
<h2 id="Docker镜像统一"><a href="#Docker镜像统一" class="headerlink" title="Docker镜像统一"></a>Docker镜像统一</h2><ul>
<li>FLIP-111</li>
<li>问题：Docker资源分散、重复和不一致性问题，用户使用不便和维护成本</li>
<li>资源统一整合到Flink-docker github项目</li>
</ul>
<p>#JobManager</p>
<ul>
<li><p>JobManager统一内存配置</p>
</li>
<li><p>FLIP-116: 延续FLIP49术语</p>
</li>
<li><p>升级：复用之前版本的配置可能导致内存参数不同，影响性能</p>
</li>
<li><p>FLIP-108: 增加扩展资源GPU调度支持</p>
</li>
<li><p>Web UI优化</p>
<blockquote>
<p>FLIP-103：JobManager和TaskManager的日志展示</p>
<p>FLIP-99：支持展示更多历史Failover信息</p>
<p>支持Thread dump</p>
</blockquote>
</li>
</ul>
<h1 id="Flink-Time-Programs"><a href="#Flink-Time-Programs" class="headerlink" title="Flink Time Programs"></a>Flink Time Programs</h1><ul>
<li><p>Processing time </p>
<blockquote>
<p>不需要流和机器之间的协调，具有最好的性能和最低的延迟</p>
</blockquote>
</li>
</ul>
<ul>
<li><p><strong>Event time</strong> 事件时间程序必须指定如何生成事件时间水印</p>
<blockquote>
<p>1、<em>event</em> timestamp 从每个流元数据中抽取</p>
<p>2、必须定义水印产生的机制，水印是事件时间中进度信号的机制</p>
<p>3、因为要处理乱序，event time 处理会有一些延迟，但是延迟是有限时间的</p>
</blockquote>
</li>
<li><p><strong>watermarks</strong></p>
<blockquote>
<p>1、用来测量event time的处理进度</p>
<p>2、水印作为数据流的一部分流动，并带有时间戳t，时间戳t表示没有小于等于t的数据到来了</p>
</blockquote>
</li>
</ul>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1>
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/24/flink/flink社区参与/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/24/flink/flink社区参与/" class="post-title-link" itemprop="url">flink社区参与</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-24 10:35:04" itemprop="dateCreated datePublished" datetime="2020-07-24T10:35:04+08:00">2020-07-24</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flink/" itemprop="url" rel="index">
                    <span itemprop="name">flink</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/24/flink/flink社区参与/" class="post-meta-item leancloud_visitors" data-flag-title="flink社区参与" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="参与途径"><a href="#参与途径" class="headerlink" title="参与途径"></a>参与途径</h1><h2 id="邮件列表"><a href="#邮件列表" class="headerlink" title="邮件列表"></a>邮件列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#开发邮件列表</span><br><span class="line">dev@flink.apache.org      </span><br><span class="line">用途：技术讨论、社区事务讨论、了解新创建的JIRA</span><br><span class="line">讨论历史(Apache Pony)：</span><br><span class="line">https://lists.apache.org/list.html?dev@flink.apache.org</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#用户邮件列表</span><br><span class="line">user@flink.apache.org</span><br><span class="line">user-zh@flink.apache.org</span><br><span class="line">用途：使用过程中遇到的问题</span><br><span class="line">讨论历史(Apache Pony)：</span><br><span class="line">https://lists.apache.org/list.html?user@flink.apache.org</span><br><span class="line">https://lists.apache.org/list.html?user-zh@flink.apache.org</span><br><span class="line">归档(Nabble)：</span><br><span class="line">http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/</span><br><span class="line"></span><br><span class="line">#build邮件列表</span><br><span class="line">builds@flink.apache.org</span><br><span class="line">用途：flink各个分支的CI实验室测试结果</span><br><span class="line">讨论历史(Apache Pony)：</span><br><span class="line">https://lists.apache.org/list.html?builds@flink.apache.org</span><br><span class="line"></span><br><span class="line">$&#123;邮件列表&#125;-subscribe@flink.apache.org   #订阅方式  邮件列表：dev、user等</span><br><span class="line">然后回复确认邮件</span><br></pre></td></tr></table></figure>

<p>##Stack Overflow</p>
<p><a href="https://stackoverflow.com/questions/tagged/apache-flink" target="_blank" rel="noopener">https://stackoverflow.com/questions/tagged/apache-flink</a></p>
<h2 id="jira"><a href="#jira" class="headerlink" title="jira"></a>jira</h2><p><a href="https://issues.apache.org/jira/projects/FLINK/issues/FLINK-18682?filter=allopenissues" target="_blank" rel="noopener">https://issues.apache.org/jira/projects/FLINK/issues/FLINK-18682?filter=allopenissues</a></p>
<h2 id="FLIP"><a href="#FLIP" class="headerlink" title="FLIP"></a>FLIP</h2><p><a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Improvement+Proposals" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/FLINK/Flink+Improvement+Proposals</a></p>
<p>大的功能：先讨论、后开发</p>
<p>讨论 -&gt; 投票 -&gt; 开发 -&gt; 合并</p>
<p>邮件标题格式一般是：[DISCUSS]XXX</p>
<p>##提交PR（Pull Request）流程</p>
<ul>
<li><p>注册Apache JIRA账号</p>
<blockquote>
<p>JIRA是Apache项目issue管理平台</p>
<p>创建/认领issue</p>
<p>讨论具体的issue</p>
<p><a href="https://issues.apache.org/jira/projects/FLINK/issues/FLINK-18682?filter=allopenissues" target="_blank" rel="noopener">https://issues.apache.org/jira/projects/FLINK/issues/FLINK-18682?filter=allopenissues</a></p>
</blockquote>
</li>
<li><p>注册github账号</p>
<blockquote>
<p>Apache项目代码都是托管在github上</p>
<p>提交PR</p>
<p>review PR</p>
</blockquote>
</li>
<li><p>下载Flink代码</p>
<blockquote>
<p>1.Fork flink github项目到自己的github账号下</p>
<p>   找到 flink 源码 点击fork</p>
<p>   下载Flink代码仓库：git clone <a href="https://github.com/apache/flink.git" target="_blank" rel="noopener">https://github.com/apache/flink.git</a></p>
<p>2.添加自己github账号下clone的Flink仓库：</p>
<p>  git remote add [shortname] url</p>
<p>​    1.shorname 本地名称 ，代表远程仓库 例如origin</p>
<p>​    2.url为远程仓库地址 该地址必须已经存在</p>
<p>注意：如果使用 fork后，clone自己的仓库，则不需要添加远程仓库</p>
</blockquote>
</li>
<li><p>开发环境准备</p>
<blockquote>
<p>maven：3.2.5    太高可能出问题</p>
<p>java：8</p>
<p>构建整个项目：</p>
<p>mvn clean install -Dmaven.test.skip=true</p>
<p>构建完成之后，会出现build-target目录</p>
</blockquote>
</li>
<li><p>创建JIRA</p>
<blockquote>
<p>大的功能，先讨论再创建JIRA</p>
<p>针对现存JIAR:</p>
<p>1.先征求owner同意</p>
<p>2.没有owner的话，在JIRA上面ping一下模块的commiter</p>
<p>​    将JIRA assign给你</p>
<p>​    提交PR之后，需要commiter review</p>
</blockquote>
</li>
<li><p>代码开发</p>
<blockquote>
<p>code style: &lt;<a href="https://flink.apache.org/contributing/code-style-and-quality-preamble.html" target="_blank" rel="noopener">https://flink.apache.org/contributing/code-style-and-quality-preamble.html</a></p>
<p>cd docs &amp; sh build_docs.sh -p   访问<a href="http://0.0.0:4000/" target="_blank" rel="noopener">http://0.0.0:4000/</a> 查看文档效果</p>
<p>在修改的模块下 执行 mvn clean install</p>
</blockquote>
</li>
<li><p>提交PR</p>
<blockquote>
<p>​</p>
</blockquote>
</li>
<li><p>测试实验室</p>
</li>
<li><p>根据review反馈更新PR</p>
</li>
</ul>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://flink.apache.org/community.html#how-to-subscribe-to-a-mailing-list" target="_blank" rel="noopener">邮件列表</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/23/flink/flink源码构建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/23/flink/flink源码构建/" class="post-title-link" itemprop="url">Flink源码构建</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-23 10:05:35" itemprop="dateCreated datePublished" datetime="2020-07-23T10:05:35+08:00">2020-07-23</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flink/" itemprop="url" rel="index">
                    <span itemprop="name">flink</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/23/flink/flink源码构建/" class="post-meta-item leancloud_visitors" data-flag-title="Flink源码构建" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="构建步骤"><a href="#构建步骤" class="headerlink" title="构建步骤"></a>构建步骤</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>下载flink源码</span><br><span class="line"><span class="meta">$</span> git clone https://github.com/apache/flink.git</span><br><span class="line"><span class="meta">#</span> idea安装 Scala插件</span><br><span class="line"><span class="meta">#</span> plugin -&gt; Scala -&gt; 重启idea</span><br><span class="line"><span class="meta">#</span> 安装配置Checkstyle 插件</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 构建命令</span><br><span class="line"><span class="meta">$</span> mvn clean install -T 4 -Dfast -Dmaven.compile.fork=true -DskipTests -Dscala-2.11</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 构建单独module</span><br><span class="line"><span class="meta">$</span> mvn clean install -Dfast -Dmaven.compile.fork=true -DskipTests -Dscala-2.11</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 打包</span><br><span class="line"><span class="meta">$</span> cd flink-dist </span><br><span class="line"><span class="meta">$</span> mvn clean package -Dfast -Dmaven.compile.fork=true -DskipTests -Dscala-2.11</span><br></pre></td></tr></table></figure>

<h1 id="源码修改"><a href="#源码修改" class="headerlink" title="源码修改"></a>源码修改</h1><ul>
<li>源码修改后，需要重新打包进行测试</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>首先install 修改过的包，如修改了flink-streaming-java module下面的代码</span><br><span class="line"><span class="meta">$</span> cd flink-streaming-java</span><br><span class="line"><span class="meta">$</span> mvn -DskipTests -Dmaven.javadoc.skip=true -Dcheckstyle.skip=true clean install </span><br><span class="line"><span class="meta">$</span> cd flink-dist </span><br><span class="line"><span class="meta">$</span> mvn -DskipTests -Dmaven.javadoc.skip=true -Dcheckstyle.skip=true clean install</span><br></pre></td></tr></table></figure>

<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.11/flinkDev/ide_setup.html" target="_blank" rel="noopener">Flink Development</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1419606" target="_blank" rel="noopener">《Flink 源码解析》—— 源码编译运行</a></p>
<p><a href="https://blog.csdn.net/baifanwudi/article/details/99564142" target="_blank" rel="noopener">Flink打包编译问题</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/23/java/maven实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/23/java/maven实战/" class="post-title-link" itemprop="url">maven实战</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-23 09:09:55" itemprop="dateCreated datePublished" datetime="2020-07-23T09:09:55+08:00">2020-07-23</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/23/java/maven实战/" class="post-meta-item leancloud_visitors" data-flag-title="maven实战" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/22/linux/用户和组实践/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/22/linux/用户和组实践/" class="post-title-link" itemprop="url">用户和组实践</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-22 09:19:00" itemprop="dateCreated datePublished" datetime="2020-07-22T09:19:00+08:00">2020-07-22</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/22/linux/用户和组实践/" class="post-meta-item leancloud_visitors" data-flag-title="用户和组实践" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h1><p>linux的用户和组管理基于Authentication、Authorization、Accounting，即认证、授权和审计进行</p>
<ul>
<li><p>认证</p>
<blockquote>
<p>验证用户是否可以获得权限，是3A的第一步，即验证身份</p>
</blockquote>
</li>
<li><p>授权</p>
<blockquote>
<p>授权用户可以使用那些服务或资源，即身份验证成功后，赋予这个身份相应的权限</p>
</blockquote>
</li>
<li><p>审计</p>
<blockquote>
<p>记录用户的操作情况，在Linux中，日志就是审计的一种手段</p>
</blockquote>
</li>
</ul>
<p>linux中用户分为3类</p>
<ul>
<li><p>管理员（root）</p>
<blockquote>
<p>UID为0的用户，只要是UID为0，该用户就是管理员用户</p>
</blockquote>
</li>
<li><p>普通用户（登录用户）</p>
<blockquote>
<p>一般为管理员手动添加的用户，默认仅拥有操作自身家目录中文件及目录的权限，以及进入与浏览相关目录文件的权限（如/etc、/var/log等），但没有创建、修改、删除等权限。</p>
</blockquote>
</li>
<li><p>普通用户（系统用户）</p>
<blockquote>
<p>一般为系统安装后默认存在的，且默认情况下不能登录系统，它们的存在主要是为了满足系统进程对文件属主的需求。</p>
</blockquote>
</li>
</ul>
<p>用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用UID来识别不同的用户</span><br><span class="line">根据/etc/passwd进行用户名和UID解析</span><br></pre></td></tr></table></figure>

<p>用户组</p>
<ul>
<li><p>有3中组划分方法</p>
<blockquote>
<p>1.管理员组、普通用户组（包括系统用户组和登录用户组）</p>
<p>2.用户的基本组（主组）：用户必须有且只能有一个基本组；</p>
<p>   用户的附加组 （附属组）：用户可以有0个、1个或多个附加组</p>
<p>3.私有组：每新建一个用户，如果不指定-g参数，都会自动创建一个和用户名同名的组，且组内只包含用户本身；</p>
<p>  公共组：组内可包含多个用户</p>
</blockquote>
</li>
<li><p>使用GID标识不同组</p>
</li>
</ul>
<p>用户和组相关的信息主要存储在/etc/passwd、/etc/shadow、/etc/group三个文件中，使用:分隔</p>
<ul>
<li><p>/etc/passwd：存储用户账户信息</p>
<blockquote>
<p>存储格式为，name:password:UID:GID:comment:directory:shell</p>
</blockquote>
</li>
<li><p>/etc/shadow：存储用户密码信息</p>
<blockquote>
<p>登录名:$加密算法$salt$加密了的密码:最后一次更改密码的日期:密码最小期限:密码最大期限:密码警告时间段:密码禁用期:账户过期日期:保留字段</p>
</blockquote>
</li>
<li><p>/etc/group：存储用户组信息</p>
<blockquote>
<p>存储格式为，group_name:password:GID:user_list</p>
<p>group_name：组名；<br>password：用户组的口令，用占位符x表示，一般Linux用户组都没有口令；<br>GID：组ID；<br>user_list：这里列出的是以该组为附加组的用户列表，以此组为主组的用户没有列在此处。</p>
</blockquote>
</li>
</ul>
<h1 id="命令使用"><a href="#命令使用" class="headerlink" title="命令使用"></a>命令使用</h1><h2 id="groupadd"><a href="#groupadd" class="headerlink" title="groupadd"></a>groupadd</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">groupadd [options] group_name  //新建用户</span><br><span class="line">-g GID：指定GID：默认是上一个组的GID+1</span><br><span class="line">-r：创建系统组</span><br><span class="line">示例：groupadd mygroup1;groupadd mygroup2</span><br></pre></td></tr></table></figure>

<p>##groupmod</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">groupmod [options] GROUP      //更改用户组属性</span><br><span class="line">-g GID：--gid GID：修改GID</span><br><span class="line">-n NEW_NAME，修改组名</span><br><span class="line">示例：groupmod -g 1111 -n MYGOURP mygroup1</span><br></pre></td></tr></table></figure>

<h2 id="groupdel"><a href="#groupdel" class="headerlink" title="groupdel"></a>groupdel</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupdel [options] GROUP</span><br><span class="line">不能删除主组，可以删除附加组</span><br></pre></td></tr></table></figure>

<h2 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a>useradd</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">useradd [options] login_name</span><br><span class="line">-u UID：--uid UID：指定UID，默认是上一个用户UID+1</span><br><span class="line">-g GROUP：--gid GROUP：指定用户的基本组，此组必须事先存在</span><br><span class="line">-G：--groups GROUP1,GROUP2...，指定用户的附加组，这些组必须事先存在</span><br><span class="line">-c COMMENT：--comment COMMENT：添加注释</span><br><span class="line">-d：--home HOME_DIR：指定用户家目录，通过复制/etc/skel并重命名实现的，指定的家目录路径如果事先存在，则不会为用户复制环境初始化配置文件（如.bashrc等）</span><br><span class="line">-s：--shell SHELL：指定用户默认shell，可用的所有shell列表存储在/etc/shells文件中</span><br><span class="line">-r：--system：创建系统用户</span><br><span class="line">示例：</span><br><span class="line">useradd -u 1100 -g slackware -G &quot;group1,group2&quot; -c &quot;slackware management&quot; -d /home/susehome -s /bin/zsh suse</span><br><span class="line"></span><br><span class="line">useradd -D [options]</span><br><span class="line">显示或修改用户创建时的默认配置属性</span><br><span class="line">创建用户时的诸多默认配置保存在/etc/login.defs文件中</span><br><span class="line">useradd -D 修改的配置结果保存在/etc/default/useradd文件中</span><br></pre></td></tr></table></figure>

<p>##usermod</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">usermod [options] login_name</span><br><span class="line">-u UID：--uid UID：修改UID</span><br><span class="line">-g GROUP：--gid GROUP：修改用户的基本组，此组必须事先存在</span><br><span class="line">-G：--groups GROUP1,GROUP2...，修改用户的附加组，这些组须事先存在。</span><br><span class="line">注意，原来的附加组会被覆盖。</span><br><span class="line">如果只添加不覆盖，则配合使用-a选项。</span><br><span class="line">-a：--append：与-G一同使用，添加用户的附加组</span><br><span class="line">-c COMMENT：--comment COMMENT：修改注释</span><br><span class="line">-d：--home HOME_DIR：修改用户家目录</span><br><span class="line">用户原有的文件不会被转移至新位置。</span><br><span class="line">如果需要转移，则配合使用-m选项。</span><br><span class="line">-m：--move-home：只能与-d选项一同使用，用于将原来的家目录移动为新的家目录。</span><br><span class="line">-l：--login NEW_LOGIN：修改用户登录名</span><br><span class="line">-s：--shell SHELL：修改用户默认shell</span><br><span class="line">-L：--lock：锁定用户的密码，即禁止用户登录。</span><br><span class="line">其实就是在/etc/passwd文件中用户原来的密码字符串前添加一个“!”，使其不能匹配。</span><br><span class="line">-U：--unlock：解锁用户的密码</span><br></pre></td></tr></table></figure>

<h2 id="userdel"><a href="#userdel" class="headerlink" title="userdel"></a>userdel</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">userdel [options] login_name</span><br><span class="line">-r：删除用户时一并删除用户家目录</span><br></pre></td></tr></table></figure>

<h2 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">passwd [-k] [-l] [-u [-f]] [-d] [-e] [-n mindays] [-x maxdays] [-w warndays] [-i inactivedays] [-S] [--stdin] [username]</span><br><span class="line"></span><br><span class="line">passwd：不带任何选项：修改当前登录用户自己的密码</span><br><span class="line">passwd USER：修改指定用户的密码，默认仅root用户有此权限</span><br><span class="line">-l：--lock：锁定用户</span><br><span class="line">-u：--unlock：解锁用户</span><br><span class="line">-d：--delete：清除用户密码</span><br><span class="line">-e：--expire DATE：过期期限（日期）</span><br><span class="line">-i：--inactive DAYS：非活动期限（时长）</span><br><span class="line">-n：--minimum DAYS：密码的最短使用期限</span><br><span class="line">-m：--maximum DAYS：密码的最长使用期限</span><br><span class="line">-w：--warning DAYS：警告期限</span><br></pre></td></tr></table></figure>

<h2 id="id"><a href="#id" class="headerlink" title="id"></a>id</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">id [OPTION] [USER]   //显示用户和组信息</span><br><span class="line">id：不带任何选项：显示当前登录用户自己的信息</span><br><span class="line">-u：--user：仅显示UID</span><br><span class="line">-r：--real：仅显示实际的ID</span><br><span class="line">-g：--group：仅显示用户的基本组ID</span><br><span class="line">-G：--groups：仅显示用户所属的所有组的ID</span><br><span class="line">-n：--name：显示名称，而非ID</span><br></pre></td></tr></table></figure>

<h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su [options] [-] [user [args]]</span><br><span class="line">登录式切换：会通过重新读取目标用户的配置文件来重新初始化</span><br><span class="line">su - USER</span><br></pre></td></tr></table></figure>

<h2 id="whoami"><a href="#whoami" class="headerlink" title="whoami"></a>whoami</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">相当于命令：id -un</span><br><span class="line">whoami；显示的是当前用户下的用户名</span><br><span class="line">who am i：显示的是登录时的用户名</span><br><span class="line">who：显示当前真正登录系统中的用户（不会显示那些用su命令切换用户的登录者）</span><br></pre></td></tr></table></figure>

<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://www.jianshu.com/p/b6a7db60f8c9" target="_blank" rel="noopener">Linux用户和组管理</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/21/hadoop/CDH学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/21/hadoop/CDH学习笔记/" class="post-title-link" itemprop="url">CDH学习笔记</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-21 14:13:40" itemprop="dateCreated datePublished" datetime="2020-07-21T14:13:40+08:00">2020-07-21</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/21/hadoop/CDH学习笔记/" class="post-meta-item leancloud_visitors" data-flag-title="CDH学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://www.aboutyun.com/thread-8908-1-1.html" target="_blank" rel="noopener">cloudera(CDH)官网介绍</a></p>
<p><a href="https://www.cnblogs.com/shwang/p/12112508.html" target="_blank" rel="noopener">CDH6.3.1 安装文档</a></p>
<p><a href="https://docs.cloudera.com/documentation/enterprise/latest/topics/cdh_intro.html" target="_blank" rel="noopener">官网</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/21/tools/consul学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/21/tools/consul学习笔记/" class="post-title-link" itemprop="url">consul学习笔记</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-21 09:41:40" itemprop="dateCreated datePublished" datetime="2020-07-21T09:41:40+08:00">2020-07-21</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flink/" itemprop="url" rel="index">
                    <span itemprop="name">flink</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/21/tools/consul学习笔记/" class="post-meta-item leancloud_visitors" data-flag-title="consul学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://km.qutoutiao.net/display/yunwei/consul-api" target="_blank" rel="noopener">consul-api</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/21/prometheus/Thanos学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/21/prometheus/Thanos学习笔记/" class="post-title-link" itemprop="url">thanos学习笔记</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-21 09:38:34" itemprop="dateCreated datePublished" datetime="2020-07-21T09:38:34+08:00">2020-07-21</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/promethues/" itemprop="url" rel="index">
                    <span itemprop="name">promethues</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/21/prometheus/Thanos学习笔记/" class="post-meta-item leancloud_visitors" data-flag-title="thanos学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Sidecar"><a href="#Sidecar" class="headerlink" title="Sidecar"></a>Sidecar</h1><p>​    connects to Prometheus, reads its data for query and/or uploads it to cloud storage.</p>
<p>Sidecar和Prometheus servers运行在相同的机器或者pod中。其作用就是备份prometheus的数据到对象存储桶中，并且给Thanos其他组件通过gRPC读取Prometheus指标的权限。</p>
<p>thanos sidecar 命令运行thanos的一个组件，该组件和prometheus实例一起部署。</p>
<p>这使得sidecar可选的可以上传指标到对象存储，并且允许使用storeapi查询prometheus数据。</p>
<p>详细：</p>
<p>​    它在Prometheus的远程读取API之上实现Thanos的Store API。 这使Queriers可以将Prometheus服务器视为时间序列数据的另一个来源，而无需直接与其API对话。</p>
<p>​    可选地，在Prometheus每2小时生成一次TSDB块时，Sidecar将TSDB块上载到对象存储桶中。 这使得Prometheus服务器可以以相对较低的保留时间运行，同时使其历史数据持久且可通过对象存储查询。</p>
<p>​        注意：这仍然并不意味着Prometheus可以是完全无状态的，因为如果它崩溃并重新启动，您将损失大约2个小时的指标，因此强烈建议使用Prometheus的永久磁盘。 您可以得到的最接近无状态的状态是使用远程写入（Thanos实验支持，请参阅此信息。远程写入还有其他风险和后果，而且即使崩溃了，也可能在积极的情况下丢失度量数据，因此在所有情况下都建议使用永久磁盘 。</p>
<p>​    可选地，Thanos sidecar能够查看Prometheus规则和配置，在需要时解压缩和替换环境变量，并ping Prometheus重新加载它们。 在这里阅读更多关于此的信息</p>
<p>通过Sidecar连接到Thanos集群的Prometheus服务器受一些限制和安全操作建议：</p>
<p>​    Prometheus版本在2.2.1 或以上</p>
<p>​    Prometheus配置文件的Prometheus external_labels部分在整个Thanos系统中具有唯一的标签。 这些外部标签将由sidecar使用，然后由Thanos在许多地方使用：</p>
<p>​        <a href="https://github.com/thanos-io/thanos/blob/master/docs/components/query.md" target="_blank" rel="noopener">Querier</a> to filter out store APIs to touch during query requests.<br>​        许多对象存储读取器（如压缩器和存储网关）都按Prometheus源对块进行分组。 在上载到对象存储之前，Prometheus制作的每个TSDB块都由sidecar进行了外部标签标记。</p>
<ul>
<li><p>启动命令</p>
<blockquote>
<p>/data/app/thanos/thanos sidecar –grpc-address=0.0.0.0:19091 –http-address=0.0.0.0:19192 –prometheus.url=<a href="http://127.0.0.1:9090/" target="_blank" rel="noopener">http://127.0.0.1:9090</a> –tsdb.path=/data/app/prometheus/data –log.level=info</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">命令行参数</th>
<th align="left">参数值</th>
<th align="left">参数作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">–prometheus.url</td>
<td align="left"><a href="http://127.0.0.1:9090" target="_blank" rel="noopener">http://127.0.0.1:9090</a></td>
<td align="left">Prometheus’s API，用于Sidecar查询指标数据<br>local network是性能更好的</td>
</tr>
<tr>
<td align="left">–tsdb.path</td>
<td align="left">data/app/prometheus/data</td>
<td align="left">Data directory of TSDB</td>
</tr>
<tr>
<td align="left">–http-address</td>
<td align="left">0.0.0.0:19192</td>
<td align="left">HTTP endpoint for collecting metrics on the Sidecar</td>
</tr>
<tr>
<td align="left">–grpc-address</td>
<td align="left">0.0.0.0:19091</td>
<td align="left">GRPC endpoint for StoreAPI</td>
</tr>
<tr>
<td align="left">–web.enable-lifecycle</td>
<td align="left"></td>
<td align="left">Thanos can watch changes in Prometheus configuration and refresh Prometheus configuration if</td>
</tr>
</tbody></table>
<h1 id="Ruler-Rule"><a href="#Ruler-Rule" class="headerlink" title="Ruler/Rule"></a>Ruler/Rule</h1><p>evaluates recording and alerting rules against data in Thanos for exposition and/or upload.</p>
<p>注意：建议将规则保留在本地相关Prometheus服务器中。 仅在特定情况下使用情况。 请阅读下面的详细信息。</p>
<p>thanos rule 命令评估prometheus记录和规则，通过选择的query API.</p>
<p>可以把规则看做简化的Prometheus，不需要sidecar、scrape、PromQL</p>
<p>规则数据可以被标注为满足集群标签。ha对模式可以并行运行，应该通过副本标签来区分</p>
<ul>
<li><p>启动命令</p>
<blockquote>
<p>/data/app/thanos/thanos rule –http-address=0.0.0.0:10902 –grpc-address=0.0.0.0:10901 –query=172.16.xxx.xxx:80 –log.level=info –data-dir=”/data/app/thanos” –rule-file=/data/app/prometheus/rules/* –alert.query-url=<a href="http://thanos-query-xxxx.xxxx.net" target="_blank" rel="noopener">http://thanos-query-xxxx.xxxx.net</a> —alertmanagers.url=<a href="http://172.16.xxx.xxx:80" target="_blank" rel="noopener">http://172.16.xxx.xxx:80</a></p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">参数值</th>
<th align="left">参数作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">–http-address</td>
<td align="left">19192</td>
<td align="left">Listen host:port for HTTP endpoints.</td>
</tr>
<tr>
<td align="left">–grpc-address</td>
<td align="left">10901</td>
<td align="left">Listen ip:port address for gRPC endpoints (StoreAPI)</td>
</tr>
<tr>
<td align="left">–query</td>
<td align="left">172.16.xxx.xxx:80</td>
<td align="left">Addresses of statically configured query API servers (repeatable)</td>
</tr>
<tr>
<td align="left">–data-dir</td>
<td align="left">/data/app/thanos</td>
<td align="left">data directory（没有改目录）</td>
</tr>
<tr>
<td align="left">–rule-file</td>
<td align="left">/data/app/prometheus</td>
<td align="left"></td>
</tr>
</tbody></table>
<h1 id="Querier-Query"><a href="#Querier-Query" class="headerlink" title="Querier/Query"></a>Querier/Query</h1><p>implements Prometheus’s v1 API to aggregate data from the underlying components.</p>
<h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><p>systemctl status thanos-rule -l</p>
<p>systemctl status prometheus -l</p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="http://dockone.io/article/6019" target="_blank" rel="noopener">Thanos：开源的大规模Prometheus集群解决方案</a></p>
<p><a href="https://thanos.io/" target="_blank" rel="noopener">thnos.io</a></p>
<p><a href="https://github.com/thanos-io/thanos/blob/master/docs/components/rule.md" target="_blank" rel="noopener">rule</a></p>
<p><a href="https://github.com/thanos-io/thanos/blob/master/docs/components/sidecar.md" target="_blank" rel="noopener">sidecar.md</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/21/prometheus/Prometheus学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/21/prometheus/Prometheus学习笔记/" class="post-title-link" itemprop="url">Prometheus学习笔记</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-21 09:08:35" itemprop="dateCreated datePublished" datetime="2020-07-21T09:08:35+08:00">2020-07-21</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flink/" itemprop="url" rel="index">
                    <span itemprop="name">flink</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/21/prometheus/Prometheus学习笔记/" class="post-meta-item leancloud_visitors" data-flag-title="Prometheus学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="prometheus"><a href="#prometheus" class="headerlink" title="prometheus"></a>prometheus</h1><h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><p>​    prometheus的客户端库提供4中核心指标类型。在prometheus server中没有利用类型信息，通过把数据展平成无类型的时间序列，将来可能会改变。</p>
<h2 id="Counter"><a href="#Counter" class="headerlink" title="Counter"></a>Counter</h2><p>​    counter是累加型指标，代表了一个单调递增计数器，其值仅仅能增加或者重启时置为0，不要使用counter暴露一直能够减少的指标。比如正在处理的数量，可以使用gauge代替</p>
<h2 id="gauge"><a href="#gauge" class="headerlink" title="gauge"></a>gauge</h2><p>​    gauge是仪表板的意思，表示可以任意上下波动的单个数值。其典型使用是温度、内存使用率等指标，但是也可以当做计数器使用。</p>
<h2 id="Histogram"><a href="#Histogram" class="headerlink" title="Histogram"></a>Histogram</h2><p>直方图采样观察值（通常是请求的持续时间或响应大小等），并且在可配置的buckets中计数。也能提供所有观察值的总和。</p>
<p>一个指标的直方图在抓取期间展示了多个时间序列。</p>
<pre><code>观察桶的累积计数器，显示为&lt;basename&gt; _bucket {le =“ &lt;包含上边界&gt;”}

观察值的总和，显示为&lt;basename&gt;_sum

观察值的事件数量，显示为&lt;basename&gt;_count (identical to &lt;basename&gt;_bucket{le=&quot;+Inf&quot;} above)</code></pre><p>使用 histogram_quantile()函数计算直方图的分位数或者直方图的均匀聚合。</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><h2 id="prometheus集群"><a href="#prometheus集群" class="headerlink" title="prometheus集群"></a>prometheus集群</h2><ul>
<li><p>启动命令</p>
<blockquote>
<p>/data/app/prometheus/prometheus –config.file=/data/app/prometheus/prometheus.yml –query.max-samples=500000000 –storage.remote.read-sample-limit=5e8 –log.level=info</p>
<p>./prometheus -h 查看所有的命令行参数</p>
</blockquote>
</li>
<li><p>global</p>
<blockquote>
<p>scrape_interval  抓取数据的间隔</p>
<p>evaluation_interval  评估规则的频率，用来生产报警</p>
<p>scrape_timeout   抓取数据的超时时间</p>
<p>external_labels    外部标签，每个时间序列数据和报警都会自动有</p>
</blockquote>
</li>
<li><p>scrape_configs</p>
<blockquote>
<p>job_name 做job label添加到时间序列中  必须是唯一的</p>
<p>scrape_interval  抓取间隔（覆盖全局配置的中该值）</p>
<p>honor_labels     用开控制抓取的数据中的冲突的label  默认值false  true：保持已经抓取的数据的label值，忽略掉server端的冲突的label   false：重命名冲突的label值</p>
<p>consul_sd_configs   server：consul api，用来获取抓取目标   services：抓取的目标列表 允许通过consul 目录 api 获取抓取对象</p>
<p>relabel_configs  在抓取之前，允许对任何抓取目标和label进行高级修改</p>
<p>rule_files   规则文件制定了清单列表，从匹配的文件中读取规则和报警   1.在即席查询时，聚合很多时间序列可能会变慢，Prometheus允许在规则文件中预录入表达式，这样在采集数据时，就可以直接聚合形成新的时间序列数据</p>
</blockquote>
</li>
</ul>
<h1 id="alertmanager"><a href="#alertmanager" class="headerlink" title="alertmanager"></a>alertmanager</h1><p>​    alertmanager采用高可用配置，0.15版本以及以上才支持高可用，默认是开启的。alertmanager的高可用必须让alertmanager集群实例可以相互通讯，这通过在启动alertmanager服务时通过–cluster.*参数实现和官方建议的高可用方案不一致，官方建议的是每个alertmanager都会收到报警，而这里实际上使用的slb配置。</p>
<table>
<thead>
<tr>
<th align="left">命令行参数</th>
<th align="left">作用</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">–cluster.listen-address=0.0.0.0:9094</td>
<td align="left">当前实例集群服务监听地址，默认值就是0.0.0.0:9094，因此启动时无需添加该参数</td>
<td></td>
</tr>
<tr>
<td align="left">–cluster.advertise-address=172.16.161.22:9094</td>
<td align="left">本机地址:9094   cluster advertise address    如果实例的IP地址不是RFC 6980的一部分，且带有默认路由，则标志是必需的</td>
<td></td>
</tr>
<tr>
<td align="left">–cluster.peer=172.16.161.15:9094</td>
<td align="left">初始化时关联的其它实例的集群服务地址   第一个节点启动时不需要加该参数    第二个节点启动时添加该参数，且参数相同</td>
<td></td>
</tr>
<tr>
<td align="left">–web.listen-address=0.0.0.0:9093</td>
<td align="left">服务运行地址    需要配置在prometheus中，ip:端口</td>
<td></td>
</tr>
<tr>
<td align="left">–config.file=/data/app/alertmanager/alertmanager.yml</td>
<td align="left">配置文件地址</td>
<td></td>
</tr>
<tr>
<td align="left">–log.level=info</td>
<td align="left">日志级别</td>
<td></td>
</tr>
<tr>
<td align="left">–alerts.gc-interval=30m</td>
<td align="left">Interval between alert GC.</td>
<td></td>
</tr>
</tbody></table>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><ul>
<li><p>global  resolve_timeout</p>
<blockquote>
<p>该参数定义了当Alertmanager持续多长时间未接收到告警后标记告警状态为resolved（已解决）。<br>该参数的定义可能会影响到告警恢复通知的接收时间，读者可根据自己的实际场景进行定义，其默认值为5分钟。既然是5分钟，那么为啥发送 恢复 的时间间隔小于5分钟</p>
</blockquote>
</li>
<li><p>route group_by</p>
<blockquote>
<p>用来对告警进行分组，将多条告警合并为一个通知。基于告警中包含的标签，如果满足<strong>group_by</strong>中定义标签名称，那么这些告警将会合并为一个通知发送给接收器</p>
</blockquote>
</li>
<li><p>route group_wait</p>
<blockquote>
<p>如果在等待时间内当前group接收到了新的告警，这些告警将会合并为一个通知向receiver发送。</p>
</blockquote>
</li>
<li><p>route group_interval</p>
<blockquote>
<p>则用于定义相同的Group之间发送告警通知的时间间隔。</p>
<p>也就是第二次之后发送该Group告警的间隔时间</p>
</blockquote>
</li>
<li><p>route repeat_interval</p>
</li>
<li><p>receivers send_resolved</p>
<blockquote>
<p>true发送恢复 通知  false 不发送恢复通知</p>
</blockquote>
</li>
<li><p>inhibit_rules</p>
<blockquote>
<p>source_match target_match equal</p>
<p>1.当source已经匹配时，会静默target匹配的告警</p>
<p>2.source和target必须有在equal定义的一样的label值</p>
<p>3.如果label缺失或者值为空，那么就是相等</p>
</blockquote>
</li>
</ul>
<h1 id="pushgateway"><a href="#pushgateway" class="headerlink" title="pushgateway"></a>pushgateway</h1><h2 id="指标一致性检查"><a href="#指标一致性检查" class="headerlink" title="指标一致性检查"></a>指标一致性检查</h2><p>  然而如果大量的指标是被频繁推送的pushgateway，pushgateway聚合的成本非常高，那么push的时间将会非常长。可以使用–push.disable-consistency-check 来节省一致性检查的成本，但是这将导致不一致的指标。设置了该参数，在抓取时任然会进行一致性检查，但是只要有不一致的指标，那么所有的抓取都会失败。 <a href="https://github.com/prometheus/pushgateway/issues/313" target="_blank" rel="noopener">https://github.com/prometheus/pushgateway/issues/313</a></p>
<h2 id="时间戳"><a href="#时间戳" class="headerlink" title="时间戳"></a>时间戳</h2><p>​    如果指标被推送到pushgateway的时间是t1，你可能错误地认为prometheus在同样的时间抓取他们，事实上，prometheus赋给指标的时间戳是抓取的时间。在prometheus的视角中，prometheus可以在任何时间抓取指标，直到指标被删除。验证：prometheus有时是宽容的，但是如果在5分钟内得不到一个指标的任何采样，那么将其视为已删除。pushed group（推送组）：按照推送组聚合，其实就是指标名称，每个推送组都有push_time_seconds和push_failure_time_seconds。</p>
<ul>
<li>pushgateway不需要任何配置，开箱即用</li>
<li>默认情况下，所有指标均存储在内存中，即如果重新，那么将丢失所有指标。可以通过–persistence.file 持久化于磁盘路径</li>
</ul>
<h2 id="系统指标"><a href="#系统指标" class="headerlink" title="系统指标"></a>系统指标</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">push_time_seconds，表示每个指标组最新的成功推送时间</span><br><span class="line">push_failure_time_seconds，表示每个指标组的POST/PUT的失败时间，失败的原因一般是value值非法，如果该指标没有，那么可以去掉检查</span><br><span class="line">pushgateway_http_requests_total：用来记录http请求的数量。</span><br><span class="line">pushgateway_build_info：pushgateway的版本信息</span><br><span class="line">pushgateway_http_push_duration_seconds：推送到pushgateway的http请求持续时间秒的概况</span><br><span class="line">pushgateway_http_push_duration_seconds_sum：应该是时间总和</span><br><span class="line">pushgateway_http_push_duration_seconds_count：应该是总次数</span><br><span class="line">pushgateway_http_push_size_bytes：推送到pushgateway的http请求的大小</span><br><span class="line">pushgateway_http_push_size_bytes_sum：应该是字节总大小</span><br><span class="line">pushgateway_http_push_size_bytes_count：应该是总次数</span><br><span class="line">pushgateway_http_requests_total：http请求的次数</span><br></pre></td></tr></table></figure>

<h2 id="系统方法"><a href="#系统方法" class="headerlink" title="系统方法"></a>系统方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/metrics/job/&lt;JOB_NAME&gt;&#123;/&lt;LABEL_NAME&gt;/&lt;LABEL_VALUE&gt;&#125;</span><br><span class="line">在URL中设置的label，被用作grouping key，被设置在body中的label将会被覆盖。</span><br><span class="line">验证（todo）：body中的label是否被覆盖？是否只有URL中的label才能用作grouping key？</span><br><span class="line">返回码：包含200 202 400</span><br><span class="line">200：表示成功</span><br><span class="line">400：表示失败，包括请求不符合格式，指标不一致，或者group冲突</span><br><span class="line">202：表示设置了--push.disable-consistency-check的成功推送</span><br></pre></td></tr></table></figure>

<ul>
<li><p>PUT</p>
<blockquote>
<p>用来推送一组指标，在URL路径中的所有grouping key是被PUT的指标替换？啥意思？没看懂，不是说grouping key 是URL中的指标吗 怎么又被body中的替换呢如果body是空，那么意味着删除所有grouping key的指标，与DELETE不同的是，PUT会更新push_time_seconds</p>
</blockquote>
</li>
<li><p>POST</p>
<blockquote>
<p>和put方法基本相同，区别是：<br>1.仅仅是新推送的并且名称一样才能被替换？查一下具体区别？<br>2.如果body是空，push_time_seconds也会更新，但是不会更新任何先前推送的指标值，也就是不会删除。</p>
</blockquote>
</li>
<li><p>DELETE</p>
<blockquote>
<p>请求不能包含body，所有匹配URL中grouping key的指标将被删除。成功码总是202，和PUT/POST相比具有最高执行优先级。</p>
</blockquote>
</li>
</ul>
<h2 id="pushgateway的GC时间"><a href="#pushgateway的GC时间" class="headerlink" title="pushgateway的GC时间"></a>pushgateway的GC时间</h2><table>
<thead>
<tr>
<th align="left">指标</th>
<th align="left">数值</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">go_gc_duration_seconds</td>
<td align="left">0.018889618</td>
<td align="left">持续时间的秒数</td>
</tr>
<tr>
<td align="left">go_gc_duration_seconds_count</td>
<td align="left">24547</td>
<td align="left">总次数</td>
</tr>
<tr>
<td align="left">go_gc_duration_seconds_sum</td>
<td align="left">11.83551848</td>
<td align="left">总秒数</td>
</tr>
<tr>
<td align="left">go_memstats_last_gc_time_seconds</td>
<td align="left">1584932274.8469074</td>
<td align="left">上次发生GC的时间</td>
</tr>
<tr>
<td align="left">go_memstats_gc_cpu_fraction</td>
<td align="left">0.008819378754311585</td>
<td align="left">自程序启动以来，GC时间占程序<br>可用CPU的比例，可以排除GC导致的系统CPU负载过高</td>
</tr>
<tr>
<td align="left">go_goroutines</td>
<td align="left">415</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">go_memstats_alloc_bytes</td>
<td align="left">16840443448=16G</td>
<td align="left">分配以及仍在使用的字节数</td>
</tr>
<tr>
<td align="left">go_memstats_alloc_bytes_total</td>
<td align="left">225647979901736<br>=225647G</td>
<td align="left">总共分配的字节数</td>
</tr>
<tr>
<td align="left">go_threads</td>
<td align="left">41</td>
<td align="left">系统创建的线程数</td>
</tr>
</tbody></table>
<h2 id="pushgateway处理指标"><a href="#pushgateway处理指标" class="headerlink" title="pushgateway处理指标"></a>pushgateway处理指标</h2><table>
<thead>
<tr>
<th align="left">指标</th>
<th align="left">数值</th>
<th align="left">作用</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">process_cpu_seconds_total</td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left">process_max_fds</td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left">process_open_fds</td>
<td align="left">430</td>
<td align="left">打开的文件描述符的数量</td>
<td></td>
</tr>
<tr>
<td align="left">process_resident_memory_bytes</td>
<td align="left">40902533120=40G</td>
<td align="left">常驻内存大小</td>
<td></td>
</tr>
<tr>
<td align="left">process_start_time_seconds</td>
<td align="left">1584069726</td>
<td align="left">启动的时间</td>
<td></td>
</tr>
<tr>
<td align="left">process_virtual_memory_bytes</td>
<td align="left">40G</td>
<td align="left">RAM和交互区所有内存大小</td>
<td></td>
</tr>
<tr>
<td align="left">process_virtual_memory_max_bytes</td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
</tbody></table>
<h2 id="pushgateway的http指标"><a href="#pushgateway的http指标" class="headerlink" title="pushgateway的http指标"></a>pushgateway的http指标</h2><table>
<thead>
<tr>
<th align="left">指标</th>
<th align="left">数值</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">pushgateway_http_push_duration_seconds</td>
<td align="left">0.04857185</td>
<td align="left">90线还不到0.05秒，说明写入的很快</td>
</tr>
<tr>
<td align="left">pushgateway_http_push_duration_seconds_count</td>
<td align="left">42310596</td>
<td align="left">启动以来写入的次数</td>
</tr>
<tr>
<td align="left">pushgateway_http_push_duration_seconds_sum</td>
<td align="left">1001197.3480990011</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">pushgateway_http_push_size_bytes</td>
<td align="left">1MB</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">pushgateway_http_push_size_bytes_count</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">pushgateway_http_push_size_bytes_sum</td>
<td align="left">26T</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">pushgateway_http_requests_total</td>
<td align="left">get=1455次 <br>delete=1417次 put=42337258次</td>
<td align="left"></td>
</tr>
</tbody></table>
<h2 id="scrape指标"><a href="#scrape指标" class="headerlink" title="scrape指标"></a>scrape指标</h2><table>
<thead>
<tr>
<th align="left">指标</th>
<th align="left">数值</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">scrape_duration_seconds</td>
<td align="left">69</td>
<td>最近一次prometheus从pushgateway获取指标的秒数</td>
</tr>
<tr>
<td align="left">scrape_samples_post_metric_relabeling</td>
<td align="left">2543411</td>
<td>表示度量指标的标签变化后，标签没有变化的度量指标数量。</td>
</tr>
<tr>
<td align="left">scrape_samples_scraped</td>
<td align="left">2543411</td>
<td></td>
</tr>
<tr>
<td align="left">scrape_series_added</td>
<td align="left">48926</td>
<td>本次抓取中新增时间序列的数量</td>
</tr>
</tbody></table>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://github.com/prometheus/client_java#counter" target="_blank" rel="noopener">ClientJava</a></p>
<p><a href="https://prometheus.io/docs/concepts/metric_types/" target="_blank" rel="noopener">数据类型</a></p>
<p><a href="https://prometheus.io/docs/prometheus/latest/querying/functions/#histogram_quantile" target="_blank" rel="noopener">函数</a></p>
<p><a href="https://prometheus.io/docs/practices/histograms/" target="_blank" rel="noopener">直方图详细</a></p>
<p><a href="https://km.qutoutiao.net/display/yunwei/PrometheusApi" target="_blank" rel="noopener">PrometheusApi</a></p>
<p><a href="https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/alert/prometheus-alert-rule" target="_blank" rel="noopener">prometheus-alert-rule</a></p>
<p><a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/" target="_blank" rel="noopener">configuration</a></p>
<p><a href="https://github.com/prometheus/alertmanager" target="_blank" rel="noopener">alertmanager</a></p>
<p><a href="https://prometheus.io/docs/alerting/overview/" target="_blank" rel="noopener">overview</a></p>
<p><a href="https://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/alert/install-alert-manager" target="_blank" rel="noopener">install-alert-manager</a></p>
<p><a href="https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/readmd/alertmanager-high-availability" target="_blank" rel="noopener">alertmanager-high-availability</a></p>
<p><a href="https://manpages.debian.org/testing/prometheus-alertmanager/prometheus-alertmanager.1.en.html" target="_blank" rel="noopener">prometheus-alertmanager</a></p>
<p><a href="https://github.com/prometheus/prometheus/blob/release-2.18/config/testdata/conf.good.yml" target="_blank" rel="noopener">promethues集群生产配置</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/20/hadoop/Hive元数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜纪光">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="纪光的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/07/20/hadoop/Hive元数据/" class="post-title-link" itemprop="url">hive元数据metastore</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-07-20 17:43:21" itemprop="dateCreated datePublished" datetime="2020-07-20T17:43:21+08:00">2020-07-20</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-20 12:19:35" itemprop="dateModified" datetime="2021-06-20T12:19:35+08:00">2021-06-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <span id="/2020/07/20/hadoop/Hive元数据/" class="post-meta-item leancloud_visitors" data-flag-title="hive元数据metastore" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="元数据表结构"><a href="#元数据表结构" class="headerlink" title="元数据表结构"></a>元数据表结构</h1><h2 id="VERSION"><a href="#VERSION" class="headerlink" title="VERSION"></a>VERSION</h2><p>存储Hive版本的元数据表，该表比较简单，但是很重要。如果该表出现问题，根本进入不了Hive-Cli。比如该表不存在，当启动Hive-Cli时候，就会报错”Table ‘hive.version’ doesn’t exist”。</p>
<h2 id="Hive数据库相关的元数据表-DBS、DATABASE-PARAMS"><a href="#Hive数据库相关的元数据表-DBS、DATABASE-PARAMS" class="headerlink" title="Hive数据库相关的元数据表(DBS、DATABASE_PARAMS)"></a>Hive数据库相关的元数据表(DBS、DATABASE_PARAMS)</h2><p>###DBS</p>
<p>该表存储Hive中所有数据库的基本信息。</p>
<p>DB_ID：数据库ID</p>
<p>###DATABASE_PARAMS</p>
<p>该表存储数据库的相关参数，</p>
<p>在CREATE DATABASE时候用WITH DBPROPERTIES(property_name=property_value, …)指定的参数</p>
<h2 id="Hive表和视图相关的元数据表"><a href="#Hive表和视图相关的元数据表" class="headerlink" title="Hive表和视图相关的元数据表"></a>Hive表和视图相关的元数据表</h2><p>主要有TBLS、TABLE_PARAMS、TBL_PRIVS，这三张表通过TBL_ID关联。</p>
<p>###TBLS</p>
<p>该表中存储Hive表，视图，索引表的基本信息</p>
<p>TBL_ID：表ID</p>
<p>###TABLE_PARAMS</p>
<p>该表存储表/视图的属性信息</p>
<p>###TBL_PRIVS</p>
<p>该表存储表/视图的授权信息</p>
<p>TBL_GRANT_ID：授权ID</p>
<p>##Hive文件存储信息相关的元数据表</p>
<p>​    主要涉及SDS、SD_PARAMS、SERDES、SERDE_PARAMS，由于HDFS支持的文件格式很多，而建Hive表时候也可以指定各种文件格式，Hive在将HQL解析成MapReduce时候，需要知道去哪里，使用哪种格式去读写HDFS文件，而这些信息就保存在这几张表中。</p>
<h3 id="SDS"><a href="#SDS" class="headerlink" title="SDS"></a>SDS</h3><p>​    该表保存文件存储的基本信息，如INPUT_FORMAT、OUTPUT_FORMAT、是否压缩等。</p>
<p>TBLS表中的SD_ID与该表关联，可以获取Hive表的存储信息。</p>
<p>SD_ID：存储信息ID</p>
<p>CD_ID：字段信息ID   对应CDS表</p>
<p>SERDE_ID：序列化类ID  对应SERDES表</p>
<h3 id="SD-PARAMS"><a href="#SD-PARAMS" class="headerlink" title="SD_PARAMS"></a>SD_PARAMS</h3><p>​    该表存储Hive存储的属性信息，在创建表时候使用STORED BY ‘storage.handler.class.name’ [WITH SERDEPROPERTIES (…)指定。</p>
<h3 id="SERDES"><a href="#SERDES" class="headerlink" title="SERDES"></a>SERDES</h3><p>​    该表存储序列化使用的类信息</p>
<h3 id="SERDE-PARAMS"><a href="#SERDE-PARAMS" class="headerlink" title="SERDE_PARAMS"></a>SERDE_PARAMS</h3><p>​    该表存储序列化的一些属性、格式信息，比如:行、列分隔符</p>
<h2 id="Hive表字段相关的元数据表"><a href="#Hive表字段相关的元数据表" class="headerlink" title="Hive表字段相关的元数据表"></a>Hive表字段相关的元数据表</h2><h3 id="COLUMNS-V2"><a href="#COLUMNS-V2" class="headerlink" title="COLUMNS_V2"></a>COLUMNS_V2</h3><p>​    该表存储表对应的字段信息</p>
<p>​    CD_ID：字段信息ID</p>
<h2 id="Hive表分分区相关的元数据表"><a href="#Hive表分分区相关的元数据表" class="headerlink" title="Hive表分分区相关的元数据表"></a>Hive表分分区相关的元数据表</h2><p>​     主要涉及PARTITIONS、PARTITION_KEYS、PARTITION_KEY_VALS、PARTITION_PARAMS</p>
<h3 id="PARTITIONS"><a href="#PARTITIONS" class="headerlink" title="PARTITIONS"></a>PARTITIONS</h3><p>​    该表存储表分区的基本信息</p>
<p>​    PART_ID：分区ID</p>
<h3 id="PARTITION-KEYS"><a href="#PARTITION-KEYS" class="headerlink" title="PARTITION_KEYS"></a>PARTITION_KEYS</h3><p>​    该表存储分区的字段信息</p>
<h3 id="PARTITION-KEY-VALS"><a href="#PARTITION-KEY-VALS" class="headerlink" title="PARTITION_KEY_VALS"></a>PARTITION_KEY_VALS</h3><p>​    该表存储分区字段值</p>
<h3 id="PARTITION-PARAMS"><a href="#PARTITION-PARAMS" class="headerlink" title="PARTITION_PARAMS"></a>PARTITION_PARAMS</h3><p>​    该表存储分区的属性信息</p>
<p>##其它表</p>
<p>DB_PRIVS</p>
<p>数据库权限信息表。通过GRANT语句对数据库授权后，将会在这里存储。</p>
<p>IDXS</p>
<p>索引表，存储Hive索引相关的元数据</p>
<p>INDEX_PARAMS</p>
<p>索引相关的属性信息</p>
<p>TBL_COL_STATS</p>
<p>表字段的统计信息。使用ANALYZE语句对表字段分析后记录在这里</p>
<p>TBL_COL_PRIVS</p>
<p>表字段的授权信息</p>
<p>PART_PRIVS</p>
<p>分区的授权信息</p>
<p>PART_COL_PRIVS</p>
<p>分区字段的权限信息</p>
<p>PART_COL_STATS</p>
<p>分区字段的统计信息</p>
<p>FUNCS</p>
<p>用户注册的函数信息</p>
<p>FUNC_RU</p>
<p>用户注册函数的资源信息</p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODUxMzQxMA==&mid=2663993556&idx=1&sn=0e5291bd63426d747f32a7fd05128caa&scene=21#wechat_redirect" target="_blank" rel="noopener">Hive元数据表结构详解</a></p>
<p><a href="https://www.cnblogs.com/bonelee/p/12441622.html" target="_blank" rel="noopener">Hive基本架构和原理</a></p>
<p><a href="https://blog.csdn.net/qq_40990732/article/details/80914873" target="_blank" rel="noopener">Hive Metastore原理及配置</a></p>
<p><a href="https://cloud.tencent.com/developer/news/362488" target="_blank" rel="noopener">Hive架构和工作原理</a></p>
<p><a href="https://blog.csdn.net/m0_37534613/article/details/55258928" target="_blank" rel="noopener">Hive分桶之BUCKET详解</a></p>
<p><a href="https://blog.csdn.net/qq_26803795/article/details/105205702?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">一文彻底学会hive分桶表（实战详解）</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">姜纪光</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">158</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">姜纪光</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">
      
    主题 – <a href="https://mist.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.4.1
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/muse.js?v=7.4.1"></script>

<script src="/js/next-boot.js?v=7.4.1"></script>



  





















  

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'MIQC4jJTknc0hjNXDAiIuQ21-9Nh9j0Va',
    appKey: 'vaiXpSQLLMglwYsVLOBLzck4',
    placeholder: "Just go go",
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: 'zh-cn' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

</body>
</html>
